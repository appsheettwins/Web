<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</title>

<style>
*{box-sizing:border-box;font-family:'Sarabun','Segoe UI',sans-serif}
body{background:linear-gradient(135deg,#667eea,#764ba2);padding:14px}
.container{max-width:900px;margin:auto}
.card{background:#fff;border-radius:22px;padding:28px;margin-bottom:20px}
.hidden{display:none}
.top-admin{position:fixed;top:14px;right:14px;z-index:99}
.top-admin button{
background:#111;color:#fff;border:none;
padding:10px 16px;border-radius:14px}
input,select,button{width:100%;padding:14px;margin-top:10px;font-size:1.1em}
button{background:#667eea;color:#fff;border:none;border-radius:14px}
.btn-secondary{background:#6c757d}
</style>
</head>

<body>

<!-- ADMIN BUTTON -->
<div class="top-admin">
<button onclick="openLogin()">‚öôÔ∏è Admin</button>
</div>

<div class="container">

<!-- FORM (‡πÄ‡∏î‡∏¥‡∏°) -->
<div class="card" id="formSection">
<h2 style="text-align:center">üôè ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</h2>
<input id="donorName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
<input id="amount" type="number" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô">
<select id="purpose"></select>
<button onclick="saveDonation()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
</div>

<!-- LOGIN -->
<div class="card hidden" id="loginSection">
<h2 style="text-align:center">üîê Admin Login</h2>
<input id="adminUser" placeholder="Username">
<input id="adminPass" type="password" placeholder="Password">
<button onclick="loginAdmin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
<button class="btn-secondary" onclick="backHome()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
</div>

<!-- ADMIN -->
<div class="card hidden" id="adminSection">
<h3>üõ†Ô∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</h3>
<input id="newPurpose" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡∏°‡πà">
<button onclick="addPurpose()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
<ul id="purposeList"></ul>
<button class="btn-secondary" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>

</div>

<script>
const scriptUrl="PUT_YOUR_WEBAPP_URL_HERE";

/* ---------- PURPOSE (‡πÄ‡∏î‡∏¥‡∏°) ---------- */
async function loadPurposes(){
const r=await fetch(scriptUrl+"?action=getPurposes");
const d=await r.json();
purpose.innerHTML="";
d.purposes.forEach(p=>{
const o=document.createElement("option");
o.textContent=o.value=p;
purpose.appendChild(o);
});
}
loadPurposes();

/* ---------- ADMIN ---------- */
function openLogin(){
formSection.classList.add("hidden");
loginSection.classList.remove("hidden");
}

function backHome(){
loginSection.classList.add("hidden");
formSection.classList.remove("hidden");
}

async function loginAdmin(){
const r=await fetch(`${scriptUrl}?action=login&user=${adminUser.value}&pass=${adminPass.value}`);
const d=await r.json();
if(d.success){
loginSection.classList.add("hidden");
adminSection.classList.remove("hidden");
loadAdminPurposes();
}else alert("Login ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
}

async function loadAdminPurposes(){
const r=await fetch(scriptUrl+"?action=getPurposes");
const d=await r.json();
purposeList.innerHTML="";
d.purposes.forEach((p,i)=>{
purposeList.innerHTML+=`
<li>${p}
<button onclick="deletePurpose(${i+2})">‚ùå</button>
</li>`;
});
}

async function addPurpose(){
await fetch(scriptUrl,{
method:"POST",
body:new URLSearchParams({
action:"addPurposeAdmin",
purpose:newPurpose.value
})
});
newPurpose.value="";
loadAdminPurposes();
loadPurposes();
}

async function deletePurpose(row){
await fetch(scriptUrl,{
method:"POST",
body:new URLSearchParams({
action:"deletePurposeAdmin",
row:row
})
});
loadAdminPurposes();
loadPurposes();
}

function logout(){
adminSection.classList.add("hidden");
formSection.classList.remove("hidden");
}

/* ---------- SAVE DONATION (‡πÄ‡∏î‡∏¥‡∏°) ---------- */
function saveDonation(){
fetch(scriptUrl,{
method:"POST",
body:new URLSearchParams({
name:donorName.value,
amount:amount.value,
purpose:purpose.value
})
});
alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
}
</script>
</body>
</html>
