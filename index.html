<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</title>

<style>
*{
    box-sizing:border-box;
    -webkit-tap-highlight-color: transparent;
}

body{
    font-family:'Sarabun','Segoe UI',sans-serif;
    background:linear-gradient(135deg,#667eea,#764ba2);
    min-height:100vh;
    padding:12px;
}

/* ---------- Layout ---------- */
.container{
    max-width:720px;
    margin:auto;
}

.card{
    background:#fff;
    border-radius:20px;
    padding:28px;
    box-shadow:0 15px 40px rgba(0,0,0,.25);
    margin-bottom:20px;
}

/* ---------- Header ---------- */
h1{
    text-align:center;
    font-size:1.8em;
    color:#764ba2;
    margin-bottom:6px;
}

.subtitle{
    text-align:center;
    font-size:1.05em;
    color:#666;
    margin-bottom:25px;
}

/* ---------- Form ---------- */
.form-group{
    margin-bottom:22px;
}

label{
    font-size:1.2em;
    font-weight:600;
    margin-bottom:8px;
    display:block;
}

/* ‚≠êÔ∏è ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡∏ç‡πà ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ */
input,
select,
textarea{
    width:100%;
    font-size:1.35em;
    padding:16px 18px;
    border-radius:14px;
    border:2px solid #e0e0e0;
    transition:.25s;
}

input:focus,
select:focus,
textarea:focus{
    outline:none;
    border-color:#667eea;
    box-shadow:0 0 0 4px rgba(102,126,234,.15);
}

textarea{
    min-height:110px;
    resize:vertical;
}

/* ---------- Button ---------- */
button{
    width:100%;
    font-size:1.4em;
    padding:18px;
    border-radius:16px;
    border:none;
    font-weight:600;
    color:#fff;
    background:linear-gradient(135deg,#667eea,#764ba2);
    cursor:pointer;
}

button:active{
    transform:scale(.98);
}

/* ---------- Certificate ---------- */
.certificate{
    background:linear-gradient(135deg,#fff9e6,#ffe6cc);
    border:10px double #c19a6b;
    border-radius:16px;
    padding:32px 20px;
    text-align:center;
}

.cert-header{
    font-size:2.2em;
    color:#8b4513;
    margin-bottom:18px;
}

.cert-body{
    font-size:1.35em;
    line-height:1.9;
}

.cert-name{
    font-size:1.6em;
    font-weight:bold;
    color:#8b4513;
}

.cert-amount{
    font-size:1.9em;
    color:#d4af37;
    font-weight:bold;
    margin:10px 0;
}

.cert-footer{
    margin-top:30px;
    font-size:1.2em;
    color:#555;
}

/* ---------- Utility ---------- */
.hidden{display:none;}

.button-group{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
    margin-top:20px;
}

.btn-secondary{
    background:#6c757d;
}

/* ---------- Mobile Extra ---------- */
@media(max-width:480px){
    h1{font-size:1.6em;}
    input,select,textarea{font-size:1.4em;}
    button{font-size:1.45em;}
}
</style>
</head>

<body>
<div class="container">

<div class="card">
<h1>üôè ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</h1>
<p class="subtitle">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤</p>

<div id="formSection">

<div class="form-group">
<label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç</label>
<input id="donorName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" required>
</div>

<div class="form-group">
<label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
<input id="amount" type="number" min="1" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1000" required>
</div>

<div class="form-group">
<label>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç</label>
<select id="purpose"></select>
</div>

<div class="form-group">
<label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
<textarea id="note"></textarea>
</div>

<button onclick="generateCertificate()">üé´ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</button>

</div>
</div>

<div id="certificateSection" class="card hidden">
<div class="certificate" id="certificate">
<div class="cert-header"></div>
<div class="cert-body"></div>
<div class="cert-footer"></div>
</div>

<div class="button-group">
<button onclick="saveToImage()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ</button>
<button class="btn-secondary" onclick="createNew()">‚ûï ‡∏£‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà</button>
</div>
</div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
const scriptUrl="https://script.google.com/macros/s/AKfycby9pH_JP8PpdGWzazdTjZw72hhsKnj_Uzd0TI-kHidhuK7qI4vmPMq-CspmaoHcKITQ/exec";

window.onload=()=>loadPurposes();

async function loadPurposes(){
const r=await fetch(scriptUrl+"?action=getPurposes");
const d=await r.json();
const s=document.getElementById("purpose");
s.innerHTML="";
(d.purposes||["‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ"]).forEach(p=>{
let o=document.createElement("option");
o.value=o.textContent=p;
s.appendChild(o);
});
}

function generateCertificate(){
const n=donorName.value.trim();
const a=amount.value;
if(!n||!a){alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");return;}

certificate.querySelector(".cert-header").innerHTML="‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£<br>‚ò∏Ô∏è Certificate of Merit ‚ò∏Ô∏è";
certificate.querySelector(".cert-body").innerHTML=`
‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏±‡∏Å‡∏Ç‡∏µ‡∏û‡∏¢‡∏≤‡∏ô‡∏ß‡πà‡∏≤
<div class="cert-name">${n}</div>
‡πÑ‡∏î‡πâ‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç ${purpose.value}
<div class="cert-amount">${Number(a).toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
${note.value?`‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${note.value}<br>`:""}
‡∏Ç‡∏≠‡∏≠‡∏≤‡∏ô‡∏¥‡∏™‡∏á‡∏™‡πå‡πÅ‡∏´‡πà‡∏á‡∏ö‡∏∏‡∏ç‡∏Å‡∏∏‡∏®‡∏•‡∏ô‡∏µ‡πâ
`;
certificate.querySelector(".cert-footer").innerHTML=
"‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà "+new Date().toLocaleDateString("th-TH")+"<br>üôè ‡∏™‡∏≤‡∏ò‡∏∏ üôè";

formSection.classList.add("hidden");
certificateSection.classList.remove("hidden");

saveToGoogleSheets(n,a,purpose.value,note.value);
}

function saveToGoogleSheets(n,a,p,no){
const fd=new FormData();
fd.append("name",n);
fd.append("amount",a);
fd.append("purpose",p);
fd.append("note",no);
fetch(scriptUrl,{method:"POST",body:fd});
}

function saveToImage(){
html2canvas(certificate).then(c=>{
let a=document.createElement("a");
a.download="‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£.png";
a.href=c.toDataURL();
a.click();
});
}

function createNew(){
formSection.classList.remove("hidden");
certificateSection.classList.add("hidden");
donorName.value=amount.value=note.value="";
}
</script>

</body>
</html>
