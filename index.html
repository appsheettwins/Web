<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</title>

<style>
*{box-sizing:border-box;font-family:'Sarabun','Segoe UI',sans-serif}
body{
background:linear-gradient(135deg,#667eea,#764ba2);
padding:14px;min-height:100vh}
.container{max-width:820px;margin:auto}

/* ---------- Card ---------- */
.card{
background:#fff;border-radius:22px;
padding:28px;margin-bottom:20px;
box-shadow:0 20px 45px rgba(0,0,0,.25)}

/* ---------- Header ---------- */
h1{text-align:center;color:#764ba2;margin-bottom:6px}
.subtitle{text-align:center;color:#666;margin-bottom:22px}

/* ---------- Form ---------- */
label{font-size:1.15em;font-weight:600}
.form-group{margin-bottom:18px}
input,select,textarea{
width:100%;padding:16px;
font-size:1.35em;border-radius:14px;
border:2px solid #e0e0e0}
button{
width:100%;padding:18px;
font-size:1.35em;border-radius:16px;
border:none;font-weight:600;
background:linear-gradient(135deg,#667eea,#764ba2);
color:#fff}

/* ---------- Theme selector ---------- */
.theme-list{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
gap:12px;margin-top:10px}

.theme{
padding:16px;border-radius:14px;
cursor:pointer;text-align:center;
font-weight:600;border:3px solid transparent}

.theme.active{border-color:#667eea}

/* ---------- Certificate ---------- */
.certificate{
padding:32px;border-radius:20px;
text-align:center;margin-top:20px}

.theme-gold{
background:linear-gradient(135deg,#fff9e6,#ffe6b3);
border:10px double #c19a6b}

.theme-purple{
background:linear-gradient(135deg,#ede7f6,#d1c4e9);
border:8px solid #7e57c2}

.theme-green{
background:linear-gradient(135deg,#e8f5e9,#c8e6c9);
border:8px solid #2e7d32}

.cert-name{font-size:1.6em;font-weight:bold;margin:10px 0}
.cert-amount{font-size:1.9em;font-weight:bold;margin:12px 0}

/* ---------- Collection ---------- */
.collection{
display:grid;gap:14px;margin-top:20px}
.collection .certificate{
font-size:.9em;opacity:.9}

/* ---------- Utility ---------- */
.hidden{display:none}
.button-group{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:18px}
.btn-secondary{background:#6c757d}
</style>
</head>

<body>
<div class="container">

<!-- FORM -->
<div class="card" id="formSection">
<h1>üôè ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</h1>
<p class="subtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏∞‡∏™‡∏°‡πÑ‡∏î‡πâ</p>

<div class="form-group">
<label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
<input id="donorName">
</div>

<div class="form-group">
<label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
<input id="amount" type="number">
</div>

<div class="form-group">
<label>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</label>
<select id="purpose">
<option>‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
<option>‡∏ñ‡∏ß‡∏≤‡∏¢‡∏™‡∏±‡∏á‡∏Ü‡∏ó‡∏≤‡∏ô</option>
<option>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏®‡∏≤‡∏™‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô</option>
</select>
</div>

<div class="form-group">
<label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</label>
<div class="theme-list">
<div class="theme active" data-theme="theme-gold">‚ú® ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å</div>
<div class="theme" data-theme="theme-purple">üíú ‡πÇ‡∏°‡πÄ‡∏î‡∏¥‡∏£‡πå‡∏ô</div>
<div class="theme" data-theme="theme-green">üåø ‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥</div>
</div>
</div>

<button onclick="previewCert()">üëÄ ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
</div>

<!-- PREVIEW -->
<div class="card hidden" id="previewSection">
<div id="certificate" class="certificate theme-gold"></div>

<div class="button-group">
<button onclick="saveCert()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏∞‡∏™‡∏°</button>
<button class="btn-secondary" onclick="backForm()">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö</button>
</div>
</div>

<!-- COLLECTION -->
<div class="card hidden" id="collectionSection">
<h2>üìö ‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</h2>
<div class="collection" id="collection"></div>

<button onclick="newCert()" style="margin-top:15px">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</button>
</div>

</div>

<script>
const scriptUrl="https://script.google.com/macros/s/AKfycby9pH_JP8PpdGWzazdTjZw72hhsKnj_Uzd0TI-kHidhuK7qI4vmPMq-CspmaoHcKITQ/exec";
let selectedTheme="theme-gold";

/* theme click */
document.querySelectorAll(".theme").forEach(t=>{
t.onclick=()=>{
document.querySelectorAll(".theme").forEach(x=>x.classList.remove("active"));
t.classList.add("active");
selectedTheme=t.dataset.theme;
};
});

function previewCert(){
const c=document.getElementById("certificate");
c.className="certificate "+selectedTheme;
c.innerHTML=`
<h2>‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£</h2>
‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡πÇ‡∏°‡∏ó‡∏ô‡∏≤‡∏ö‡∏∏‡∏ç‡πÅ‡∏î‡πà
<div class="cert-name">${donorName.value}</div>
‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç ${purpose.value}
<div class="cert-amount">${Number(amount.value).toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date().toLocaleDateString("th-TH")}
üôè ‡∏™‡∏≤‡∏ò‡∏∏ üôè`;
formSection.classList.add("hidden");
previewSection.classList.remove("hidden");
}

function saveCert(){
saveToSheet();
const clone=certificate.cloneNode(true);
document.getElementById("collection").prepend(clone);
previewSection.classList.add("hidden");
collectionSection.classList.remove("hidden");
}

function saveToSheet(){
const fd=new FormData();
fd.append("name",donorName.value);
fd.append("amount",amount.value);
fd.append("purpose",purpose.value);
fetch(scriptUrl,{method:"POST",body:fd});
}

function backForm(){
previewSection.classList.add("hidden");
formSection.classList.remove("hidden");
}

function newCert(){
donorName.value=amount.value="";
collectionSection.classList.add("hidden");
formSection.classList.remove("hidden");
}
</script>
</body>
</html>
